import { db } from "../../db";
import { statsBT } from "../../schema";
import { formatPercent } from "../../utils/formatPercent";

export const showStatsResults = async () => {
	const results = await db.select().from(statsBT);

	console.table(
		results
			.sort((a, b) => Number(b.totalPositions) - Number(a.totalPositions))
			.sort((a, b) => Number(b.winRate) - Number(a.winRate))
			.sort((a, b) => Number(a.minAccPnl) - Number(b.minAccPnl))
			.sort((a, b) => Number(b.maxDrawdown) - Number(a.maxDrawdown))
			.sort((a, b) => Number(b.accPnl) - Number(a.accPnl))
			.map((r) => ({
				sl: formatPercent(Number(r.sl)),
				tp: formatPercent(Number(r.tp)),
				maxTradeLength: Number(r.maxTradeLength),
				totalPositions: Number(r.totalPositions),
				maxAccPnl: formatPercent(Number(r.maxAccPnl)),
				minAccPnl: formatPercent(Number(r.minAccPnl)),
				accPnl: formatPercent(Number(r.accPnl)),
				maxDrawdown: formatPercent(Number(r.maxDrawdown)),
				winRate: formatPercent(Number(r.winRate)),
			}))
	);
};

showStatsResults();

// ┌────┬────────┬────────┬────────────────┬────────────────┬───────────┬───────────┬─────────┬─────────────┬─────────┐
// │    │ sl     │ tp     │ maxTradeLength │ totalPositions │ maxAccPnl │ minAccPnl │ accPnl  │ maxDrawdown │ winRate │
// ├────┼────────┼────────┼────────────────┼────────────────┼───────────┼───────────┼─────────┼─────────────┼─────────┤
// │  0 │ 10.00% │ 10.00% │ 100            │ 173            │ 109.78%   │ -13.21%   │ 90.60%  │ 54.81%      │ 54.91%  │
// │  1 │ 10.00% │ 10.00% │ 100            │ 173            │ 109.78%   │ -13.21%   │ 90.60%  │ 54.81%      │ 54.91%  │
// │  2 │ 10.00% │ 10.00% │ 100            │ 173            │ 109.78%   │ -13.21%   │ 90.60%  │ 54.81%      │ 54.91%  │
// │  3 │ 10.00% │ 10.00% │ 100            │ 173            │ 109.78%   │ -13.21%   │ 90.60%  │ 54.81%      │ 54.91%  │
// │  4 │ 10.00% │ 10.00% │ 50             │ 306            │ 81.35%    │ -32.97%   │ 69.21%  │ 96.05%      │ 55.88%  │
// │  5 │ 10.00% │ 10.00% │ 50             │ 306            │ 81.35%    │ -32.97%   │ 69.21%  │ 96.05%      │ 55.88%  │
// │  6 │ 10.00% │ 10.00% │ 50             │ 306            │ 81.35%    │ -32.97%   │ 69.21%  │ 96.05%      │ 55.88%  │
// │  7 │ 10.00% │ 10.00% │ 50             │ 306            │ 81.35%    │ -32.97%   │ 69.21%  │ 96.05%      │ 55.88%  │
// │  8 │ 15.00% │ 10.00% │ 200            │ 92             │ 67.13%    │ -44.35%   │ 56.25%  │ 44.35%      │ 55.43%  │
// │  9 │ 15.00% │ 10.00% │ 200            │ 92             │ 67.13%    │ -44.35%   │ 56.25%  │ 44.35%      │ 55.43%  │
// │ 10 │ 10.00% │ 10.00% │ 200            │ 96             │ 59.19%    │ -24.79%   │ 50.44%  │ 39.18%      │ 50.00%  │
// │ 11 │ 10.00% │ 10.00% │ 200            │ 96             │ 59.19%    │ -24.79%   │ 50.44%  │ 39.18%      │ 50.00%  │
// │ 12 │ 10.00% │ 10.00% │ 200            │ 96             │ 59.19%    │ -24.79%   │ 50.44%  │ 39.18%      │ 50.00%  │
// │ 13 │ 10.00% │ 10.00% │ 200            │ 96             │ 59.19%    │ -24.79%   │ 50.44%  │ 39.18%      │ 50.00%  │
// │ 14 │ 10.00% │ 15.00% │ 100            │ 169            │ 85.53%    │ -13.21%   │ 47.84%  │ 81.92%      │ 52.07%  │
// │ 15 │ 10.00% │ 15.00% │ 100            │ 169            │ 85.53%    │ -13.21%   │ 47.84%  │ 81.92%      │ 52.07%  │
// │ 16 │ 15.00% │ 10.00% │ 50             │ 302            │ 57.65%    │ -55.57%   │ 45.51%  │ 96.11%      │ 56.29%  │
// │ 17 │ 15.00% │ 10.00% │ 50             │ 302            │ 57.65%    │ -55.57%   │ 45.51%  │ 96.11%      │ 56.29%  │
// │ 18 │ 15.00% │ 15.00% │ 200            │ 86             │ 56.69%    │ -44.35%   │ 32.75%  │ 44.35%      │ 55.81%  │
// │ 19 │ 10.00% │ 15.00% │ 50             │ 305            │ 50.23%    │ -64.80%   │ 22.78%  │ 115.03%     │ 55.41%  │
// │ 20 │ 10.00% │ 15.00% │ 50             │ 305            │ 50.23%    │ -64.80%   │ 22.78%  │ 115.03%     │ 55.41%  │
// │ 21 │ 15.00% │ 15.00% │ 50             │ 300            │ 35.34%    │ -76.27%   │ 6.96%   │ 111.61%     │ 55.67%  │
// │ 22 │ 15.00% │ 10.00% │ 100            │ 167            │ 14.19%    │ -121.85%  │ -0.72%  │ 121.85%     │ 51.50%  │
// │ 23 │ 15.00% │ 10.00% │ 100            │ 167            │ 14.19%    │ -121.85%  │ -0.72%  │ 121.85%     │ 51.50%  │
// │ 24 │ 15.00% │ 15.00% │ 100            │ 163            │ 0.00%     │ -103.80%  │ -47.00% │ 103.80%     │ 48.47%  │
// │ 25 │ 10.00% │ 15.00% │ 200            │ 97             │ 0.00%     │ -108.94%  │ -69.70% │ 108.94%     │ 45.36%  │
// │ 26 │ 10.00% │ 15.00% │ 200            │ 97             │ 0.00%     │ -108.94%  │ -69.70% │ 108.94%     │ 45.36%  │
// └────┴────────┴────────┴────────────────┴────────────────┴───────────┴───────────┴─────────┴─────────────┴─────────┘
